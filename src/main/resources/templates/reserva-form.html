<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Reserva de Hotel</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
<div class="container py-5">
    <h1 class="text-center mb-4">Reservar en <span th:text="${hotel.nombre}">Nombre Hotel</span></h1>
    
    <div class="mb-4">
        <h5>Dirección:</h5>
        <p th:text="${hotel.direccion}">Dirección del hotel</p>
    </div>

    <form method="post" th:action="@{/reserva/guardar}">
        <input type="hidden" name="hotelId" th:value="${hotel.id}" />

        <!-- Sección Cliente -->
        <div class="card mb-4">
            <div class="card-header">Datos del Cliente</div>
            <div class="card-body row g-3">
                <div class="col-md-6">
                    <label class="form-label">Nombre completo</label>
                    <input type="text" class="form-control" name="nombre" required>
                </div>
                <div class="col-md-6">
                    <label class="form-label">DNI</label>
                    <input type="text" class="form-control" name="dni" required>
                </div>
                <div class="col-md-6">
                    <label class="form-label">Correo electrónico</label>
                    <input type="email" class="form-control" name="email" required>
                </div>
                <div class="col-md-6">
                    <label class="form-label">Teléfono</label>
                    <input type="tel" class="form-control" name="telefono" required>
                </div>
            </div>
        </div>

        <!-- Fechas -->
        <div class="card mb-4">
            <div class="card-header">Fechas de la Reserva</div>
            <div class="card-body row g-3">
                <div class="col-md-6">
                    <label class="form-label">Fecha de Entrada</label>
                    <input type="date" class="form-control" name="fechaInicio" required>
                </div>
                <div class="col-md-6">
                    <label class="form-label">Fecha de Salida</label>
                    <input type="date" class="form-control" name="fechaFin" required>
                </div>
            </div>
        </div>

        <!-- Selección de habitaciones -->
        <div class="card mb-4">
            <div class="card-header">Seleccionar habitaciones</div>
            <div class="card-body">
                <div id="habitacionesContainer">
                    <!-- Se añadirán selects aquí -->
                </div>
                <button type="button" class="btn btn-outline-primary mt-3" onclick="añadirHabitacion()">Añadir habitación</button>
                <div class="mt-3">
                    <strong>Total: <span id="precioTotal">S/ 0.00</span></strong>
                </div>
            </div>
        </div>

        <!-- Botones -->
        <div class="text-center">
            <button type="submit" class="btn btn-success">Reservar</button>
            <button type="button" class="btn btn-secondary" onclick="verificarEstado()">Verificar Estado de Habitaciones</button>
        </div>
    </form>
</div>

<script>
    const precios = {
        "1": 150.00,
        "2": 180.00,
        "4": 350.00
    };

    const nombres = {
        "1": "Habitación Simple",
        "2": "Habitación Doble",
        "4": "Habitación Suite"
    };

    let contador = 0;

    function añadirHabitacion() {
        contador++;
        const contenedor = document.getElementById('habitacionesContainer');
        const div = document.createElement('div');
        div.className = 'mb-3';
        div.innerHTML = `
            <label class="form-label">Habitación ${contador}</label>
            <select class="form-select habitacion-select" name="habitaciones[]" onchange="actualizarPrecioTotal()">
                <option value="">-- Selecciona --</option>
                <option value="1">1 persona (Simple)</option>
                <option value="2">2 personas (Doble)</option>
                <option value="4">4 personas (Suite)</option>
            </select>
            <div class="mt-1 text-muted detalle-habitacion"></div>
        `;
        contenedor.appendChild(div);
    }

    function actualizarPrecioTotal() {
        let total = 0;
        const selects = document.querySelectorAll('.habitacion-select');
        selects.forEach(select => {
            const valor = select.value;
            const detalle = select.nextElementSibling;
            if (precios[valor]) {
                total += precios[valor];
                detalle.textContent = `${nombres[valor]} - S/ ${precios[valor].toFixed(2)}`;
            } else {
                detalle.textContent = '';
            }
        });
        document.getElementById('precioTotal').textContent = `S/ ${total.toFixed(2)}`;
    }

    function verificarEstado() {
        alert("Funcionalidad de verificación de estado en desarrollo...");
    }

    // Agrega la primera habitación al cargar
    window.onload = añadirHabitacion;
</script>
</body>
</html>

